--- Makefile.orig	2022-10-09 22:13:57.000000000 +0100
+++ Makefile	2022-10-09 23:19:38.000000000 +0100
@@ -1,8 +1,8 @@
 
-CC      := $(CROSS_HOST)gcc
-PKGCONF := $(CROSS_HOST)pkg-config
-CFLAGS  := -g -Wall -pthread -O3 $(EXTRA_CFLAGS)
-LDFLAGS := -g -lm -pthread $(EXTRA_LDFLAGS)
+CC      ?= $(CROSS_HOST)gcc
+PKGCONF ?= $(CROSS_HOST)pkg-config
+CFLAGS  ?= -g -Wall -pthread -O3 $(EXTRA_CFLAGS)
+LDFLAGS ?= -g -lm -pthread $(EXTRA_LDFLAGS)
 OBJS    := hacktv.o common.o fir.o vbidata.o teletext.o wss.o video.o mac.o dance.o eurocrypt.o videocrypt.o videocrypts.o syster.o acp.o vits.o nicam728.o test.o ffmpeg.o file.o hackrf.o
 PKGS    := libavcodec libavformat libavdevice libswscale libswresample libavutil libhackrf $(EXTRA_PKGS)
 
@@ -32,8 +32,16 @@
 	$(CC) $(CFLAGS) -c $< -o $@
 	@$(CC) $(CFLAGS) -MM $< -o $(@:.o=.d)
 
+# Macports wants the install phase to be "make install DESTDIR=blah" 
+# (see https://guide.macports.org/chunked/reference.phases.html ) so 
+# to allow both macports and non-macports builds, we reallly should
+# either detect macports or DESTDIR and act accordingly. However, for
+# now let's just assume it's only macports trying to build us.
+# Macports wants opt/local
 install:
-	cp -f hacktv $(PREFIX)/usr/local/bin/
+	mkdir -p $(DESTDIR)/bin/
+	install -c hacktv $(DESTDIR)/opt/local/bin/
+#OLD	cp -f hacktv $(PREFIX)/usr/local/bin/
 
 clean:
 	rm -f *.o *.d hacktv hacktv.exe
